<h1>Add New Vehicle</h1>

<%- messages() %>

<% if (errors) { %>
  <ul class="notice">
    <% errors.array().forEach(error => { %>
      <li><%= error.msg %></li>
    <% }) %>
  </ul>
<% } %>

<form action="/inv/add-inventory" method="post" id="inventoryForm">
  
  <label for="classificationList">Classification:</label>
  <%- classificationList %>
  
  <label for="inv_make">Make:
    <input 
      type="text" 
      id="inv_make" 
      name="inv_make" 
      value="<%= locals.inv_make || '' %>" 
      required 
      minlength="3">
  </label>
  
  <label for="inv_model">Model:
    <input 
      type="text" 
      id="inv_model" 
      name="inv_model" 
      value="<%= locals.inv_model || '' %>" 
      required 
      minlength="3">
  </label>
  
  <label for="inv_year">Year:
    <input 
      type="number" 
      id="inv_year" 
      name="inv_year" 
      value="<%= locals.inv_year || '' %>" 
      required 
      min="1900" 
      max="2099">
  </label>
  
  <label for="inv_description">Description:
    <textarea 
      id="inv_description" 
      name="inv_description" 
      required><%= locals.inv_description || '' %></textarea>
  </label>
  
  <label for="inv_image">Image Path:
    <input 
      type="text" 
      id="inv_image" 
      name="inv_image" 
      value="<%= locals.inv_image || '/images/vehicles/no-image.png' %>" 
      required>
  </label>
  
  <label for="inv_thumbnail">Thumbnail Path:
    <input 
      type="text" 
      id="inv_thumbnail" 
      name="inv_thumbnail" 
      value="<%= locals.inv_thumbnail || '/images/vehicles/no-image-tn.png' %>" 
      required>
  </label>
  
  <label for="inv_price">Price:
    <input 
      type="number" 
      id="inv_price" 
      name="inv_price" 
      value="<%= locals.inv_price || '' %>" 
      required 
      min="0" 
      step="0.01">
  </label>
  
  <label for="inv_miles">Miles:
    <input 
      type="number" 
      id="inv_miles" 
      name="inv_miles" 
      value="<%= locals.inv_miles || '' %>" 
      required 
      min="0" 
      step="1">
  </label>
  
  <label for="inv_color">Color:
    <input 
      type="text" 
      id="inv_color" 
      name="inv_color" 
      value="<%= locals.inv_color || '' %>" 
      required>
  </label>
  
  <!-- Inline error messages -->
  <div id="inventoryError" class="error-message" style="color:red; margin-top:10px;"></div>
  
  <button type="submit">Add Vehicle</button>
</form>

<script>
const form = document.getElementById('inventoryForm');
const yearInput = document.getElementById('inv_year');
const priceInput = document.getElementById('inv_price');
const milesInput = document.getElementById('inv_miles');
const classificationInput = document.getElementById('classificationList');
const errorDiv = document.getElementById('inventoryError');

form.addEventListener('submit', e => {
  errorDiv.textContent = ''; // clear previous errors
  const messages = [];

  if (yearInput.value.length !== 4) {
    messages.push('Year must be a 4-digit number.');
  }
  if (parseFloat(priceInput.value) < 0) {
    messages.push('Price must be a positive number.');
  }
  if (parseInt(milesInput.value) < 0) {
    messages.push('Miles must be a positive number.');
  }
  if (!classificationInput.value) {
    messages.push('Please select a classification.');
  }

  if (messages.length > 0) {
    e.preventDefault();
    errorDiv.innerHTML = messages.join('<br>');
  }
});
</script>
